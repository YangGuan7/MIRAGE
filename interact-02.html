<!DOCTYPE html>
<html dir="ltr" lang="zh-TW">
<head>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<!-- Stylesheets
	============================================= -->
	<link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,400i,600,700|Montserrat:300,400,700|Caveat+Brush&display=swap" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="css/bootstrap.css" type="text/css" />
	<link rel="stylesheet" href="css/style.css" type="text/css" />
	<link rel="stylesheet" href="css/dark.css" type="text/css" />
	<link rel="stylesheet" href="css/swiper.css" type="text/css" />

	<link rel="stylesheet" href="css/font-icons.css" type="text/css" />
	<link rel="stylesheet" href="css/animate.css" type="text/css" />
	<link rel="stylesheet" href="css/magnific-popup.css" type="text/css" />

	<!-- Bootstrap Switch CSS -->
	<link rel="stylesheet" href="css/components/bs-switches.css" type="text/css" />

	<link rel="stylesheet" href="css/custom.css" type="text/css" />
 

	<!-- tittle icon -->
	<link rel="icon" href="./uploads/feature/squarelogo.png" type="image/x-icon">
	<!-- Document Title
	============================================= -->
	<title>2022.01.24_告五人_新增Ai互動1</title>

</head>

<body class="stretched">
	<div class="bg-color2"></div>

	<!-- Document Wrapper
	============================================= -->
	<div id="wrapper" class="clearfix">

		<header id="header" class="no-sticky transparent-header dark header-size-md" data-sticky-shrink="false">
			<div id="header-wrap">
				<div class="container">
					<div class="header-row justify-content-lg-between">
						<!-- Logo
						============================================= -->
						<div id="logo" class="me-lg-0">
							<a href="interact.html"><i class="icon-line-chevron-left"></i></a> <span class="ms-2 display-1-5" data-bs-toggle="modal" data-bs-target=".bs-example-modal-fs-2" style="cursor:pointer"><span id="show-title">2022.01.24_告五人_新增Ai互動1</span><i class="icon-pencil2 ms-2"></i></span>
						</div><!-- #logo end -->

						<nav class="primary-menu">


						</nav><!-- #primary-menu end -->

						<nav class="primary-menu">

						</nav>

					</div>
				</div>
			</div>
			<div class="header-wrap-clone" style="height: 121px;"></div>
		</header>

		<section>
			<div class="content-wrap py-0" style="overflow: visible;">
				<div class="container clearfix">
					<div class="row gutter-20 align-items-stretch">
						<div class="col-md-12 d-flex dark mt-5 friend-list">
							<a href="#" onclick="init_tabs(); return false;"><div class="btn btn-lg rounded-6 px-4 me-2" style="background: rgba(255,255,255,0.2);"><img class="rounded-circle" src="uploads/users/001/profile.jpg" width="50" alt="User"></div></a>
							<div class="vr mx-2"></div>
							<button type="button" class="btn btn-lg rounded-6 btn-outline-light px-4 mx-2" data-bs-toggle="modal" data-bs-target=".bs-example-modal-fs"><i class="icon-line-user-plus"></i></button>
						</div>
						<div class="col-md-12 min-vh-50 tabs tabs-bb rounded-6 bg-white-op dark top-right-triangle" id="tabs">
							<div class="row">
								<div class="col-md-12">
									<ul class="menu-container one-page-menu d-flex justify-content-center">
										<li class="menu-item"><a class="menu-link" href="#hands"><div class="display-1-5">手勢</div></a></li>
										<li class="menu-item"><a class="menu-link" href="#voice"><div class="display-1-5">語音</div></a></li>
										<li class="menu-item"><a class="menu-link" href="#hands"><div class="display-1-5">姿態</div></a></li>
									</ul>
								</div>
							</div>
							<div class="tab-container clearfix">
								<div class="tab-content dark px-3" id="hands" style="height:700px">
									<div class="row">
										<div class="col-md-12 mb-4">
											<div class="row d-flex align-items-center justify-content-between">
												<div class="col-md-6">
													<input type="text" class="form-control bg-transparent text-white border-top-0 border-start-0 border-end-0" value="2022.01.24_告五人_新增互動1">
												</div>
												<div class="col-md-4 text-end">
													<button type="button" class="btn btn-sm rounded-pill btn-outline-light px-3 mx-2" onclick="empty_div('.capture-list');">重置</button>
												</div>
											</div>
										</div>
									</div>
									<div class="row h-75" style="max-height: 480px;">
										<div class="col-md-6 h-100">
											<div class="row h-100">
												<div class="col-md-12 h-100">
													<div class="rounded-6 dark bg-black" style="overflow: hidden;position:relative;">
														<div class="col-md-12" style="display: flex;overflow: hidden;justify-content: center;">
															<div class="camera-flash"></div>
															<div id="n1" class="count-time-number">3</div>
															<div id="n2" class="count-time-number">2</div>
															<div id="n3" class="count-time-number">1</div>
															<video id="video" class="flip-video bg-black" style="width: auto; height:100%"></video>
															<canvas id='canvas' class="d-none"></canvas>
														</div>
														<div style="position: absolute;bottom: 10px; width: 100%;text-align: center;z-index:20">
															<div class="take-rm-text rounded-6 px-3 py-2 d-none">試著擺出不同角度的動作，讓訓練更加精確！</div>
															<i class="take-pic icon-circle display-5" style="cursor:pointer;"></i>
															<i class="stop-take-pic icon-stop-circle1 display-5 text-danger d-none" style="cursor:pointer;"></i>
														</div>
														<div style="position: absolute;bottom:20px; right:20px; z-index:10">
															<span class="count_num_f display-6">0</span>
															<span>/ 100</span>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="col-md-6 h-100">
											<div class="capture-list row h-100 disabled-scrollbar d-block" style="overflow:scroll">
												<div class="d-flex align-items-center justify-content-center h-100">
													<p class="text-center">按下左方拍照按鈕開始訓練專屬互動！</p>
												</div>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-md-12 mt-4">
											<div class="row d-flex align-items-center justify-content-between">
												<div class="col-md-4">
												</div>
												<div class="col-md-4 text-end">
													<button type="button" class="btn btn-lg rounded-pill btn-outline-light px-4 mx-2">新增</button>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="tab-content dark px-3" id="voice" style="height:700px">
									<div class="row">
										<div class="col-md-12 mb-4">
											<div class="row d-flex align-items-center justify-content-between">
												<div class="col-md-6">
													<input type="text" class="form-control bg-transparent text-white border-top-0 border-start-0 border-end-0" value="2022.01.24_告五人_新增語音1">
												</div>
												<div class="col-md-4 text-end">
													<button type="button" class="btn btn-sm rounded-pill btn-outline-light px-3 mx-2">重置</button>
												</div>
											</div>
										</div>
									</div>
									<div class="row h-75">
										<div class="col-md-6 h-100">
											<div class="row h-50">
												<div class="col-md-12 h-100">
													<div class="h-100 border border-light rounded-6 dark py-5 px-3">
														<div id="bars">
														</div>
													</div>
												</div>
											</div>
											<div class="row">
												<div class="col-md-12 my-5 text-center">
													<button type="button" class="btn rounded-pill btn-light px-3 mx-2">5S</button>

													<button type="button" class="btn rounded-pill btn-outline-light px-3 mx-2">10S</button>

													<button type="button" class="btn rounded-pill btn-outline-light px-3 mx-2">15S</button>

													<button type="button" class="btn rounded-pill btn-outline-light px-3 mx-2">20S</button>
												</div>
												<div class="col-md-12 text-center">
													<button type="button" class="btn btn-lg rounded-pill btn-light px-3 mx-2 btn-record"><i class="icon-dot-circle1"></i> 開始錄製</button>
												</div>
											</div>
										</div>
										<div class="col-md-6 h-100">
											<div class="row h-100 voice-record d-block disabled-scrollbar" style="overflow:scroll">
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-md-12 mt-4">
											<div class="row d-flex align-items-center justify-content-between">
												<div class="col-md-4">
												</div>
												<div class="col-md-4 text-end">
													<button type="button" class="add-voice btn btn-lg rounded-pill btn-outline-light px-4 mx-2">新增</button>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="col-md-12 min-vh-50 list-content rounded-6 dark" style="display:none;">
							<div class="row">
								<div class="col-md-12 text-center">
									<h4 class="mb-4">AI互動清單</h4>
									<div style="position:absolute; right:10px; top:0">
										<button class="btn btn-sm rounded-pill btn-outline-light px-3 edit-sort">編輯</button>
									</div>
								</div>
								<ul id="sortable" class="col-md-12 list-content-append">
									
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>

	</div><!-- #wrapper end -->

	<div class="modal bs-example-modal-fs" tabindex="-1" role="dialog" aria-labelledby="fsModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-fullscreen">
			<div class="modal-content">
				<div class="modal-body p-0">
					
					<div class="bg-color2"></div>
					<section class="col-md-12 vh-100">
						<header class="sticky transparent-header dark" data-sticky-shrink="false">
							<div id="header-wrap" class="bg-transparent">
								<div class="container">
									<div class="header-row justify-content-lg-between">
										<!-- Logo
										============================================= -->
										<div id="logo" class="me-lg-0">
											<a href="#" data-bs-dismiss="modal" aria-hidden="true"><i class="icon-line-chevron-left"></i></a><span class="px-2">邀請好友新增互動</span>
										</div><!-- #logo end -->

										<nav class="primary-menu">

										</nav>

									</div>
								</div>
							</div>
						</header>
						<div class="h-100 bg-transparent d-flex align-items-center justify-content-center" data-animate="fadeIn">
							<div class="container text-center">
								<div class="col-md-12 h-100 dark">
									<div class="row gutter-20 align-items-stretch">
										<div class="col-md-3 min-vh-35" data-animate="fadeIn">
											<div class="grid-inner friend-card rounded-6 h-100 d-flex align-items-center justify-content-center">
												<div class="dark clearfix text-center">
													<div class="usericon">
														<img class="rounded-circle mb-3" src="uploads/users/003/profile.png" width="120" alt="User">
													</div>
													<h4 class="mb-4">Floyd Miles</h4>
													<button class="btn btn-outline-light rounded-pill py-2 px-4 mt-4 add-user">新增</button>
												</div>
											</div>
										</div>

										<div class="col-md-3 min-vh-35" data-animate="fadeIn">
											<div class="grid-inner friend-card rounded-6 h-100 d-flex align-items-center justify-content-center">
												<div class="dark clearfix text-center">
													<div class="usericon">
														<img class="rounded-circle mb-3" src="uploads/users/004/profile.png" width="120" alt="User">
													</div>
													<h4 class="mb-4">Ellie Lin</h4>
													<button class="btn btn-outline-light rounded-pill py-2 px-4 mt-4 add-user">新增</button>
												</div>
											</div>
										</div>

										<div class="col-md-3 min-vh-35" data-animate="fadeIn">
											<div class="grid-inner friend-card rounded-6 h-100 d-flex align-items-center justify-content-center">
												<div class="dark clearfix text-center">
													<div class="usericon">
														<img class="rounded-circle mb-3" src="uploads/users/005/profile.png" width="120" alt="User">
													</div>
													<h4 class="mb-4">Floyd Miles</h4>
													<button class="btn btn-outline-light rounded-pill py-2 px-4 mt-4 add-user">新增</button>
												</div>
											</div>
										</div>

										<div class="col-md-3 min-vh-35" data-animate="fadeIn">
											<div class="grid-inner friend-card rounded-6 h-100 d-flex align-items-center justify-content-center">
												<div class="dark clearfix text-center">
													<div class="usericon">
														<img class="rounded-circle mb-3" src="uploads/users/006/profile.png" width="120" alt="User">
													</div>
													<h4 class="mb-4">Floyd Miles</h4>
													<button class="btn btn-outline-light rounded-pill py-2 px-4 mt-4 add-user">新增</button>
												</div>
											</div>
										</div>

										<div class="col-md-3 min-vh-35" data-animate="fadeIn">
											<div class="grid-inner friend-card rounded-6 h-100 d-flex align-items-center justify-content-center">
												<div class="dark clearfix text-center">
													<div class="usericon">
														<img class="rounded-circle mb-3" src="uploads/users/007/profile.png" width="120" alt="User">
													</div>
													<h4 class="mb-4">Via Liao</h4>
													<button class="btn btn-outline-light rounded-pill py-2 px-4 mt-4 add-user">新增</button>
												</div>
											</div>
										</div>

										<div class="col-md-3 min-vh-35" data-animate="fadeIn">
											<div class="grid-inner friend-card rounded-6 h-100 d-flex align-items-center justify-content-center">
												<div class="dark clearfix text-center">
													<div class="usericon">
														<img class="rounded-circle mb-3" src="uploads/users/008/profile.png" width="120" alt="User">
													</div>
													<h4 class="mb-4">Hailey Yang</h4>
													<button class="btn btn-outline-light rounded-pill py-2 px-4 mt-4 add-user">新增</button>
												</div>
											</div>
										</div>

										<div class="col-md-3 min-vh-35" data-animate="fadeIn">
											<div class="grid-inner friend-card rounded-6 h-100 d-flex align-items-center justify-content-center">
												<div class="dark clearfix text-center">
													<div class="usericon">
														<img class="rounded-circle mb-3" src="uploads/users/009/profile.png" width="120" alt="User">
													</div>
													<h4 class="mb-4">Floyd Miles</h4>
													<button class="btn btn-outline-light rounded-pill py-2 px-4 mt-4 add-user">新增</button>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</section>
				</div>
			</div>
		</div>
	</div>

	<div class="modal bs-example-modal-fs-2" tabindex="-1" role="dialog" aria-labelledby="fsModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-fullscreen">
			<div class="modal-content">
				<div class="modal-body p-0">
					
					<div class="bg-color2"></div>
					<section class="col-md-12 vh-100">
						<header class="sticky transparent-header dark" data-sticky-shrink="false">
							<div id="header-wrap" class="bg-transparent">
								<div class="container">
									<div class="header-row justify-content-lg-between">
										<!-- Logo
										============================================= -->
										<div id="logo" class="me-lg-0">
											<a href="#" data-bs-dismiss="modal" aria-hidden="true"><i class="icon-line-chevron-left"></i></a><span class="px-2">修改名稱</span>
										</div><!-- #logo end -->

										<nav class="primary-menu">

										</nav>

									</div>
								</div>
							</div>
						</header>
						<div class="h-100 bg-transparent d-flex align-items-center justify-content-center" data-animate="fadeIn">
							<div class="container text-center">
								<div class="col-md-12 h-100 dark">
									<div class="row">
										<div class="col-md-6 mx-auto">
											<div class="input-group mb-3">
												<input type="text" name="edit-title" id="edit-title" class="form-control form-control-lg bg-transparent text-white rounded-pill" value="">
											</div>

											<div class="my-4">
												<button class="btn btn-lg btn-outline-light rounded-pill px-5 me-2" data-bs-dismiss="modal" aria-hidden="true">取消</button>
												<button id="change_name" class="btn btn-lg btn-outline-light rounded-pill px-5">確定</button>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</section>
				</div>
			</div>
		</div>
	</div>

	<div class="dark noti-first"><div class="col-md-4 display-1-5 rounded-6 py-4 px-5"><i class="icon-line-alert-circle"></i> 選擇上方訓練方式新增互動</div></div>

	<div class="dark noti-success" style="display:none;"><div class="col-md-4 display-1-5 rounded-6 py-4 px-5"><i class="icon-line-check-circle"></i> <span class="text"></span></div></div>

	<!-- JavaScripts
	============================================= -->
	<script src="js/jquery.js"></script>
	<script src="js/plugins.min.js"></script>
	<script src="js/jquery-ui.min.js"></script>

	<!-- Footer Scripts
	============================================= -->
	<script src="js/functions.js"></script>
	<script type="text/javascript">
		var bar = '<div class="bar"></div>';
		var voice_re = '<div class="col-md-12 mb-3 h-25"><div class="h-100 border border-light rounded-6 py-4 px-3"></div></div>';
		var list_content = '<li><button class="btn btn-lg rounded-pill btn-outline-light px-3 mx-2 d-block col-md-12 text-start mb-3"><img class="rounded-circle me-2" src="uploads/users/001/profile.jpg" width="35" alt="User">2022.01.24_語音01</button></li>';
		var i = 1;
		var is_showed = 0;
		var count_nummm = 0;

		var video = document.getElementById('video');
	    var canvas = document.getElementById('canvas');
	    var context = canvas.getContext('2d');
	    var strr;

	    var interval = null;

	    function opencam() {
	        if (navigator.mediaDevices.getUserMedia) {
	            navigator.mediaDevices.getUserMedia({
	                video: true
	            })
				.then(function(stream) {
				  const mediaSource = new MediaSource(stream);
			        try {
			            video.srcObject = stream;
			        } catch (error) {
			            video.src = URL.createObjectURL(mediaSource);
			        }
			        video.play();
			        strr = stream;
				})
				.catch(function(err) {
				  alert(err.name);
				});
	        }
	    }

	    function closecam() {
	        video.pause();
	        try {
	            video.srcObject = null;
	        } catch (error) {
	            video.src = null;
	        }
	        var track = strr.getTracks()[0];
	        track.stop();
	    }

	    function capture(){
	    	canvas.width=video.clientWidth;
	        canvas.height=video.clientHeight;
	        context.drawImage(video, 0, 0,video.clientWidth, video.clientHeight);
	        var data = canvas.toDataURL('image/png');
					count_nummm += 1;
					if(count_nummm >= 100){
						$('.count_num_f').html('&#x221E;');
					}else{
						$('.count_num_f').html(count_nummm);
					}
					
	        $('.capture-list').prepend('<div class="col-md-4 mb-3 h-25 d-inline-block"><div class="h-100 rounded-6 d-flex justify-content-center align-items-center bg-black flip-video" style="overflow:hidden"><img src="'+data+'"></div></div>');
	        $(".camera-flash").fadeIn(50).fadeOut(50);
	    }


	    function empty_div(name){
	    	$(name).empty();
				count_nummm = 0;
				$('.count_num_f').html('0');
	    }

		function voice() {
			var w = $('#bars').width();
			var num = Math.round(w/18);

			setTimeout(function() {
				$(bar).css('height', Math.floor(Math.random() * 60) + 50 +'%').hide().appendTo('#bars').fadeIn(100);
				// $('#bars').append(bar).fadeIn();
				console.log(num);
				i++;
				if (i <= num) {
			  		voice(); 
				}else{
					$('.btn-record').find('i').removeClass('text-danger');
					setTimeout(function() {
						$('.voice-record').prepend(voice_re);
						$('#bars').clone().hide().appendTo(".voice-record > div:first > div").fadeIn(300);
						$('#bars').empty();
						i = 1;
					},1000);
				}
			}, 100)

			return true;
		}

		function init_tabs(){
			$('.tabs').toggle();
			if ( $('.tabs').is(':visible') ){
				$('.list-content').hide();
				opencam();
			}else{
				closecam();
				$('.list-content').fadeIn();
			}
		}

		function noti_success(text){
			$('.noti-success > div > span.text').html(text);
			$('.noti-success').fadeIn(300);
			setTimeout(function() {
				$('.noti-success').fadeOut(300);
			},2000);
		}

		$(document).ready(function() {

			 $("#tabs").tabs({
	            activate: function( event, ui ) {
				    $('.capture-list').html('<div class="d-flex align-items-center justify-content-center h-100">\
													<p class="text-center">按下左方拍照按鈕開始訓練專屬互動！</p>\
												</div>');
	                empty_div('.take-rm-text');
	                empty_div('.voice-record');
	                is_showed = 0;
	            }
		     });

			$('.btn-record').click(function(){
				$(this).find('i').addClass('text-danger');
				voice();
			});

			$('.add-user').click(function(){
				var url = $(this).parent().find('.usericon img').attr('src');
				var content = '<div class="btn btn-lg rounded-6 px-4 mx-2" style="background: rgba(255,255,255,0.2);"><img class="rounded-circle" src="'+url+'" width="50" alt="User"></div>';
				$(this).closest('.grid-inner').parent().remove();
				$(content).hide().appendTo('.friend-list').fadeIn(500);
				$('.modal').modal('hide');
				noti_success("新增成功");
			});

			if ( $('.tabs').is(':visible') ){
				$('.list-content').fadeOut();
				opencam();
			}else{
				closecam();
				$('.list-content').fadeIn();
			}

			$('.bs-example-modal-fs-2').on('shown.bs.modal', function () {
				$('#edit-title').val($('#show-title').text());
				$("#change_name").on("click", function(e) {
				    $('#show-title').text($('#edit-title').val());
				    $('.bs-example-modal-fs-2').modal('hide');
				    noti_success("修改成功");
				});
			});

			$('.add-voice').on('click', function(e) {
				e.preventDefault();
				if($('.voice-record > div').length > 0 ){
					// init_tabs();
					$(list_content).hide().appendTo('.list-content-append').fadeIn(500);
					noti_success("新增成功");
					$('.voice-record').empty();
					$('#logo > a').attr('href','interact-saved.html');
				}
				
			});

			setTimeout(function() {
					$('.noti-first').fadeOut(300);
			},5000);

			$('.edit-sort').on('click', function(e) {
				$("#sortable").sortable();

				if($(this).text()=='完成'){
					noti_success("編輯成功");
					$("#sortable li").removeClass('sort');
				}else{
					$("#sortable li").addClass('sort');
				}

				$(this).text(function(i, v){
	               return v === '編輯' ? '完成' : '編輯'
	            });
				e.preventDefault();
				
			});
			
		    $('.take-pic').click(function(event) {
			    $('#n1').show(0).delay(800).hide(0);
			    $('#n2').delay(1000).show(0).delay(800).hide(0);
			    $('#n3').delay(2000).show(0).delay(800).hide(0);
			    $('.take-rm-text').addClass('d-none');
			    setTimeout(function() {
			    	$('.icon-stop-circle1').removeClass('d-none');
			    	$('.icon-circle').addClass('d-none');
			    	$('.take-rm-text').removeClass('d-none');
				    $('.take-rm-text').html('試著擺出不同角度的動作，讓訓練更加精確！');
				    if(is_showed==0){
				    	$('.capture-list').empty();
				    	is_showed = 1;
				    }
			    	interval = setInterval(capture, 200);
				},3000);
		    });

		    $('.stop-take-pic').click(function(event) {
		    	// closecam();
		    	$('.icon-stop-circle1').addClass('d-none');
		    	$('.icon-circle').removeClass('d-none');
			    // $('.take-rm-text').addClass('d-none');
			    $('.take-rm-text').html('繼續訓練，讓互動更加完整！');
			    clearInterval(interval);
		    });

		});
		 
	</script>


</body>
</html>
